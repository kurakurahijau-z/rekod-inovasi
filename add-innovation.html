<!doctype html>
<html lang="ms">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tambah Inovasi</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <script src="config.js"></script>
  <script src="app.js"></script>
</head>

<body class="min-h-screen bg-[#fbfbfe] text-slate-800">
  <div class="mx-auto max-w-3xl px-6 py-10">
    <div class="flex items-start justify-between gap-6">
      <div>
        <div class="text-2xl font-extrabold tracking-tight text-slate-900">Tambah Inovasi</div>
        <div class="mt-1 text-sm text-slate-600">Isi ringkas dulu, nanti boleh kemaskan.</div>
      </div>
      <a href="./dashboard.html" class="rounded-xl border border-slate-200 bg-white px-4 py-2 text-sm hover:bg-slate-50">← Back</a>
    </div>

    <div class="mt-6 rounded-3xl border border-slate-200 bg-white p-6 shadow-sm">
      <form id="form" class="grid gap-4">
        <div>
          <label class="text-sm font-medium text-slate-700">Tajuk</label>
          <input id="tajuk" class="mt-1 w-full rounded-xl border border-slate-200 px-4 py-2 outline-none focus:ring-2 focus:ring-indigo-200" placeholder="Contoh: SISTEM SATU CUBA" />
        </div>

        <div class="grid gap-4 md:grid-cols-2">
          <div>
            <label class="text-sm font-medium text-slate-700">Tahun</label>
            <input id="tahun" type="number" class="mt-1 w-full rounded-xl border border-slate-200 px-4 py-2 outline-none focus:ring-2 focus:ring-indigo-200" value="2026" />
          </div>
          <div>
            <label class="text-sm font-medium text-slate-700">Kategori</label>
            <input id="kategori" class="mt-1 w-full rounded-xl border border-slate-200 px-4 py-2 outline-none focus:ring-2 focus:ring-indigo-200" placeholder="PRODUK / PROSES / ..." />
          </div>
        </div>

        <div class="grid gap-4 md:grid-cols-2">
          <div>
            <label class="text-sm font-medium text-slate-700">Status</label>
            <select id="status" class="mt-1 w-full rounded-xl border border-slate-200 px-4 py-2 outline-none focus:ring-2 focus:ring-indigo-200">
              <option value="aktif">aktif</option>
              <option value="pending">pending</option>
              <option value="arkib">arkib</option>
            </select>
          </div>

          <div>
            <label class="text-sm font-medium text-slate-700">MyIPO</label>
            <select id="myipoStatus" class="mt-1 w-full rounded-xl border border-slate-200 px-4 py-2 outline-none focus:ring-2 focus:ring-indigo-200">
              <option value="no">no</option>
              <option value="yes">yes</option>
            </select>
          </div>
        </div>

        <div>
          <label class="text-sm font-medium text-slate-700">No. MyIPO (jika yes)</label>
          <input id="myipoNumber" class="mt-1 w-full rounded-xl border border-slate-200 px-4 py-2 outline-none focus:ring-2 focus:ring-indigo-200" placeholder="Contoh: LYC223456789" />
        </div>

        <div class="mt-2 flex items-center gap-2">
          <button class="rounded-xl border border-indigo-200 bg-indigo-50 px-5 py-2 text-sm font-medium text-indigo-700 hover:bg-indigo-100" type="submit">
            Simpan
          </button>
          <span class="text-sm text-slate-500" id="hint"></span>
        </div>
      </form>
    </div>

    <div id="toast" class="hidden fixed bottom-6 left-1/2 -translate-x-1/2 rounded-2xl border px-4 py-3 shadow-sm">
      <div class="text-sm" data-toast-text>Toast</div>
    </div>
  </div>

<script>
  applyThemeBase();
  if (!requireAuthOrRedirect()) {}

  qs("#form").onsubmit = async (e) => {
    e.preventDefault();
    qs("#hint").textContent = "Saving…";

    const body = {
      token: getToken(),
      tajuk: qs("#tajuk").value,
      tahun: Number(qs("#tahun").value || 2026),
      kategori: qs("#kategori").value,
      status: qs("#status").value,
      myipoStatus: qs("#myipoStatus").value,
      myipoNumber: qs("#myipoNumber").value
    };

    const r = await apiPost("createInnovation", body);
    if (!r.ok) {
      qs("#hint").textContent = "";
      return toast(r.error || "Gagal simpan", "error");
    }

    toast("Rekod disimpan", "success");
    location.href = "./dashboard.html";
  };
</script>
</body>
</html>
